{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "datasource",
          "uid": "grafana"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "description": "Dashboard to visualize App Insights data to calculate Apdex scores. https://github.com/bhozar/grafana-dashboards/tree/master/applicationinsightsapdex",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 232,
  "links": [],
  "panels": [
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 59,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "# Apdex\r\n[Apdex (Application Performance Index)](http://apdex.org/overview.html) is an open standard method for measuring application performance. It contextualizes your application's performance in terms of the quality of experience you provide to your users.\r\n\r\nApdex classifies performance into three zones based on a baseline performance threshold T you define for your app:\r\n\r\n| Zone    \t| Minimum Response Time\t| Maximum Response Time    |\r\n|-----------|-----------------------|--------------------------|\r\n|Satisfied\t|0 seconds\t            |T seconds                 |\r\n|Tolerating\t|T seconds\t            |4T seconds                |\r\n|Frustrated\t|4T seconds\t            |-                         |",
        "mode": "markdown"
      },
      "pluginVersion": "12.0.1",
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-azure-monitor-datasource",
        "uid": "000000003"
      },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Apdex Score"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red"
                    },
                    {
                      "color": "dark-orange",
                      "value": 0.51
                    },
                    {
                      "color": "dark-green",
                      "value": 0.93
                    }
                  ]
                }
              },
              {
                "id": "custom.width",
                "value": 100
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Apdex Interpretation"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 140
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Satisfied Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green"
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Tolerating Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-orange"
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Frustrated Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red"
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 4,
        "w": 24,
        "x": 0,
        "y": 8
      },
      "id": 56,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "12.0.1",
      "targets": [
        {
          "appInsights": {
            "aggOptions": [
              "sum"
            ],
            "aggregation": "sum",
            "alias": "{{metric}} {{groupbyvalue}}",
            "dimension": [
              "request/name"
            ],
            "dimensions": [
              "request/source",
              "request/name",
              "request/urlHost",
              "request/urlPath",
              "request/success",
              "request/resultCode",
              "request/performanceBucket",
              "operation/name",
              "operation/synthetic",
              "operation/syntheticSource",
              "user/authenticated",
              "application/version",
              "client/type",
              "client/model",
              "client/os",
              "client/city",
              "client/stateOrProvince",
              "client/countryOrRegion",
              "client/browser",
              "cloud/roleName",
              "cloud/roleInstance",
              "customDimensions/{OriginalFormat}",
              "customDimensions/Category",
              "customDimensions/LogLevel",
              "customDimensions/TriggerReason",
              "customDimensions/FullName",
              "customDimensions/Succeeded",
              "customDimensions/EndTime"
            ],
            "metricName": "requests/failed",
            "rawQuery": true,
            "rawQueryString": "let apdexThreshhold = toint('1390');\r\nlet apdexData = pageViews\r\n| where timestamp > ago(1d)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r\n",
            "segmentColumn": " ",
            "timeColumn": "Frustrated Users",
            "timeGrain": "auto",
            "timeGrainType": "auto",
            "valueColumn": "Frustrated Users"
          },
          "azureLogAnalytics": {
            "query": "\r\nlet apdexThreshhold = toint('$ApdexThresholdInMilliseconds');\r\nlet apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews\n//let apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').requests\n//let apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').dependencies\n// ApDex for Page Views, Requests and Dependencies\n//let apdexData = union app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews, app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').requests, app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').dependencies\n| where  $__timeFilter(timestamp)\r\n| where name in ('$operations') or '*' in ('$operations')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n// Do not consuder failures as frustrating\n// | extend Failure = iff('DoNotConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| take 250\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r",
            "resultFormat": "table",
            "workspace": "77fc47c8-51ea-4839-8155-d8c6896fcc76"
          },
          "azureMonitor": {
            "aggOptions": [],
            "dimensionFilter": "*",
            "dimensionFilters": [],
            "metricDefinition": "select",
            "metricName": "select",
            "metricNamespace": "select",
            "resourceGroup": "select",
            "resourceName": "select",
            "timeGrain": "auto",
            "timeGrains": [],
            "top": "10"
          },
          "datasource": {
            "type": "grafana-azure-monitor-datasource",
            "uid": "000000003"
          },
          "hide": false,
          "insightsAnalytics": {
            "query": "",
            "resultFormat": "time_series"
          },
          "queryType": "Azure Log Analytics",
          "refId": "A",
          "subscription": "dae9d4f9-547a-4ea7-a419-b1c34a8f9d3f"
        }
      ],
      "title": "Apdex - $resourcenames Page Views",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-azure-monitor-datasource",
        "uid": "000000003"
      },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Apdex Score"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red"
                    },
                    {
                      "color": "dark-orange",
                      "value": 0.51
                    },
                    {
                      "color": "dark-green",
                      "value": 0.93
                    }
                  ]
                }
              },
              {
                "id": "custom.width",
                "value": 100
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Apdex Interpretation"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 140
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Satisfied Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green"
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Tolerating Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-orange"
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Frustrated Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red"
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 12
      },
      "id": 60,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "12.0.1",
      "targets": [
        {
          "appInsights": {
            "aggOptions": [
              "sum"
            ],
            "aggregation": "sum",
            "alias": "{{metric}} {{groupbyvalue}}",
            "dimension": [
              "request/name"
            ],
            "dimensions": [
              "request/source",
              "request/name",
              "request/urlHost",
              "request/urlPath",
              "request/success",
              "request/resultCode",
              "request/performanceBucket",
              "operation/name",
              "operation/synthetic",
              "operation/syntheticSource",
              "user/authenticated",
              "application/version",
              "client/type",
              "client/model",
              "client/os",
              "client/city",
              "client/stateOrProvince",
              "client/countryOrRegion",
              "client/browser",
              "cloud/roleName",
              "cloud/roleInstance",
              "customDimensions/{OriginalFormat}",
              "customDimensions/Category",
              "customDimensions/LogLevel",
              "customDimensions/TriggerReason",
              "customDimensions/FullName",
              "customDimensions/Succeeded",
              "customDimensions/EndTime"
            ],
            "metricName": "requests/failed",
            "rawQuery": true,
            "rawQueryString": "let apdexThreshhold = toint('1390');\r\nlet apdexData = pageViews\r\n| where timestamp > ago(1d)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r\n",
            "segmentColumn": " ",
            "timeColumn": "Frustrated Users",
            "timeGrain": "auto",
            "timeGrainType": "auto",
            "valueColumn": "Frustrated Users"
          },
          "azureLogAnalytics": {
            "query": "\r\nlet apdexThreshhold = toint('$ApdexThresholdInMilliseconds');\r\n//let apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews\r\nlet apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').requests\n//let apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').dependencies\n// ApDex for Page Views, Requests and Dependencies\n//let apdexData = union app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews, app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').requests, app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').dependencies\n| where  $__timeFilter(timestamp)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n// Do not consuder failures as frustrating\n// | extend Failure = iff('DoNotConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| take 250\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r",
            "resultFormat": "table",
            "workspace": "77fc47c8-51ea-4839-8155-d8c6896fcc76"
          },
          "azureMonitor": {
            "aggOptions": [],
            "dimensionFilter": "*",
            "dimensionFilters": [],
            "metricDefinition": "select",
            "metricName": "select",
            "metricNamespace": "select",
            "resourceGroup": "select",
            "resourceName": "select",
            "timeGrain": "auto",
            "timeGrains": [],
            "top": "10"
          },
          "datasource": {
            "type": "grafana-azure-monitor-datasource",
            "uid": "000000003"
          },
          "hide": false,
          "insightsAnalytics": {
            "query": "",
            "resultFormat": "time_series"
          },
          "queryType": "Azure Log Analytics",
          "refId": "A",
          "subscription": "dae9d4f9-547a-4ea7-a419-b1c34a8f9d3f"
        }
      ],
      "title": "Apdex - $resourcenames Requests",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-azure-monitor-datasource",
        "uid": "000000003"
      },
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Apdex Score"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red"
                    },
                    {
                      "color": "dark-orange",
                      "value": 0.51
                    },
                    {
                      "color": "dark-green",
                      "value": 0.93
                    }
                  ]
                }
              },
              {
                "id": "custom.width",
                "value": 100
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Apdex Interpretation"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 140
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Satisfied Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-green"
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Tolerating Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-orange"
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Frustrated Users"
            },
            "properties": [
              {
                "id": "links"
              },
              {
                "id": "custom.width",
                "value": 120
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red"
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 22
      },
      "id": 61,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "12.0.1",
      "targets": [
        {
          "appInsights": {
            "aggOptions": [
              "sum"
            ],
            "aggregation": "sum",
            "alias": "{{metric}} {{groupbyvalue}}",
            "dimension": [
              "request/name"
            ],
            "dimensions": [
              "request/source",
              "request/name",
              "request/urlHost",
              "request/urlPath",
              "request/success",
              "request/resultCode",
              "request/performanceBucket",
              "operation/name",
              "operation/synthetic",
              "operation/syntheticSource",
              "user/authenticated",
              "application/version",
              "client/type",
              "client/model",
              "client/os",
              "client/city",
              "client/stateOrProvince",
              "client/countryOrRegion",
              "client/browser",
              "cloud/roleName",
              "cloud/roleInstance",
              "customDimensions/{OriginalFormat}",
              "customDimensions/Category",
              "customDimensions/LogLevel",
              "customDimensions/TriggerReason",
              "customDimensions/FullName",
              "customDimensions/Succeeded",
              "customDimensions/EndTime"
            ],
            "metricName": "requests/failed",
            "rawQuery": true,
            "rawQueryString": "let apdexThreshhold = toint('1390');\r\nlet apdexData = pageViews\r\n| where timestamp > ago(1d)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r\n",
            "segmentColumn": " ",
            "timeColumn": "Frustrated Users",
            "timeGrain": "auto",
            "timeGrainType": "auto",
            "valueColumn": "Frustrated Users"
          },
          "azureLogAnalytics": {
            "query": "\r\nlet apdexThreshhold = toint('$ApdexThresholdInMilliseconds');\r\n//let apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews\r\n//let apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').requests\nlet apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').dependencies\n// ApDex for Page Views, Requests and Dependencies\n//let apdexData = union app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews, app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').requests, app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').dependencies\n| where  $__timeFilter(timestamp)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n// Do not consuder failures as frustrating\n// | extend Failure = iff('DoNotConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| take 250\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r",
            "resultFormat": "table",
            "workspace": "77fc47c8-51ea-4839-8155-d8c6896fcc76"
          },
          "azureMonitor": {
            "aggOptions": [],
            "dimensionFilter": "*",
            "dimensionFilters": [],
            "metricDefinition": "select",
            "metricName": "select",
            "metricNamespace": "select",
            "resourceGroup": "select",
            "resourceName": "select",
            "timeGrain": "auto",
            "timeGrains": [],
            "top": "10"
          },
          "datasource": {
            "type": "grafana-azure-monitor-datasource",
            "uid": "000000003"
          },
          "hide": false,
          "insightsAnalytics": {
            "query": "",
            "resultFormat": "time_series"
          },
          "queryType": "Azure Log Analytics",
          "refId": "A",
          "subscription": "dae9d4f9-547a-4ea7-a419-b1c34a8f9d3f"
        }
      ],
      "title": "Apdex - $resourcenames Dependencies",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-azure-monitor-datasource",
        "uid": "000000003"
      },
      "description": "See how your Apdex Score changes over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "links": [],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 32
      },
      "id": 57,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "7.1.0",
      "targets": [
        {
          "appInsights": {
            "aggOptions": [
              "sum"
            ],
            "aggregation": "sum",
            "alias": "{{metric}} {{groupbyvalue}}",
            "dimension": [
              "request/name"
            ],
            "dimensions": [
              "request/source",
              "request/name",
              "request/urlHost",
              "request/urlPath",
              "request/success",
              "request/resultCode",
              "request/performanceBucket",
              "operation/name",
              "operation/synthetic",
              "operation/syntheticSource",
              "user/authenticated",
              "application/version",
              "client/type",
              "client/model",
              "client/os",
              "client/city",
              "client/stateOrProvince",
              "client/countryOrRegion",
              "client/browser",
              "cloud/roleName",
              "cloud/roleInstance",
              "customDimensions/{OriginalFormat}",
              "customDimensions/Category",
              "customDimensions/LogLevel",
              "customDimensions/TriggerReason",
              "customDimensions/FullName",
              "customDimensions/Succeeded",
              "customDimensions/EndTime"
            ],
            "metricName": "requests/failed",
            "rawQuery": true,
            "rawQueryString": "let apdexThreshhold = toint('1390');\r\nlet apdexData = pageViews\r\n| where timestamp > ago(1d)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r\n",
            "segmentColumn": " ",
            "timeColumn": "Frustrated Users",
            "timeGrain": "auto",
            "timeGrainType": "auto",
            "valueColumn": "Frustrated Users"
          },
          "azureLogAnalytics": {
            "query": "\r\nlet apdexThreshhold = toint('$ApdexThresholdInMilliseconds');\r\nlet failureThreshhold = 1;\nlet apdexData = app('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews\r\n| where  $__timeFilter(timestamp)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, bin(timestamp, 30m), InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures >= failureThreshhold, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Total = count() by timestamp, InterestingDimension\r\n| project timestamp, ApdexScore = (Satisfied + (Tolerating / 2.0)) / Total, Users = Total, InterestingDimension;\r\nlet pageRelevance = apdexData\r\n| summarize [\"Apdex Score\"] = avg(ApdexScore), Users=sum(Users) by InterestingDimension\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, 1.0 * Users * Users, Users / [\"Apdex Score\"])\r\n| order by Relevance desc\r\n| project InterestingDimension\r\n| take 7;\r\napdexData\r\n| join kind = leftouter (pageRelevance) on InterestingDimension\r\n| extend InterestingDimension = iff(isempty(InterestingDimension1) == true, 'Other', InterestingDimension)\r\n| project timestamp, ApdexScore, Users, InterestingDimension \r\n| summarize ApdexScore = avg(ApdexScore) by timestamp, InterestingDimension\r\n| extend ApdexScore = round(ApdexScore, 3)\n| order by timestamp asc",
            "resultFormat": "time_series",
            "workspace": "77fc47c8-51ea-4839-8155-d8c6896fcc76"
          },
          "azureMonitor": {
            "aggOptions": [],
            "dimensionFilter": "*",
            "dimensionFilters": [],
            "metricDefinition": "select",
            "metricName": "select",
            "metricNamespace": "select",
            "resourceGroup": "select",
            "resourceName": "select",
            "timeGrain": "auto",
            "timeGrains": [],
            "top": "10"
          },
          "datasource": {
            "type": "grafana-azure-monitor-datasource",
            "uid": "000000003"
          },
          "hide": false,
          "insightsAnalytics": {
            "query": "",
            "resultFormat": "time_series"
          },
          "queryType": "Azure Log Analytics",
          "refId": "A",
          "subscription": "dae9d4f9-547a-4ea7-a419-b1c34a8f9d3f"
        }
      ],
      "title": "$resourcenames Daily Apdex Score",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "grafana-azure-monitor-datasource",
        "uid": "000000003"
      },
      "description": "See your how the performance experience of your users have changed over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 100,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "links": [],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "count_ Frustrated"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "count_ Satisfied"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "count_ Tolerating"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 42
      },
      "id": 58,
      "options": {
        "legend": {
          "calcs": [
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "7.1.0",
      "targets": [
        {
          "appInsights": {
            "aggOptions": [
              "sum"
            ],
            "aggregation": "sum",
            "alias": "{{metric}} {{groupbyvalue}}",
            "dimension": [
              "request/name"
            ],
            "dimensions": [
              "request/source",
              "request/name",
              "request/urlHost",
              "request/urlPath",
              "request/success",
              "request/resultCode",
              "request/performanceBucket",
              "operation/name",
              "operation/synthetic",
              "operation/syntheticSource",
              "user/authenticated",
              "application/version",
              "client/type",
              "client/model",
              "client/os",
              "client/city",
              "client/stateOrProvince",
              "client/countryOrRegion",
              "client/browser",
              "cloud/roleName",
              "cloud/roleInstance",
              "customDimensions/{OriginalFormat}",
              "customDimensions/Category",
              "customDimensions/LogLevel",
              "customDimensions/TriggerReason",
              "customDimensions/FullName",
              "customDimensions/Succeeded",
              "customDimensions/EndTime"
            ],
            "metricName": "requests/failed",
            "rawQuery": true,
            "rawQueryString": "let apdexThreshhold = toint('1390');\r\nlet apdexData = pageViews\r\n| where timestamp > ago(1d)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, InterestingDimension\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures > 0, \"Frustrated\", UserExperience)\r\n| summarize Satisfied = countif(UserExperience == 'Satisfied'), Tolerating = countif(UserExperience == 'Tolerating'), Frustrated = countif(UserExperience == 'Frustrated'), Total = count() by InterestingDimension\r\n| project InterestingDimension, [\"Satisfied Users\"] = Satisfied, [\"Tolerating Users\"] = Tolerating, [\"Frustrated Users\"] = Frustrated, [\"Apdex Score\"] = round((Satisfied + (Tolerating / 2.0)) / Total, 2), Total\r\n| extend Relevance = iff([\"Apdex Score\"] == 0, pow(Total, 1.6), Total / [\"Apdex Score\"])\r\n| project-rename Users = Total\r\n| order by Relevance desc\r\n| project-away Users, Relevance;\r\napdexData\r\n| extend [\"Apdex Interpretation\"] = case([\"Apdex Score\"] <= 0.5, '⛔ Unacceptable', [\"Apdex Score\"] <= 0.7, '⚠️ Poor', [\"Apdex Score\"] <= 0.85, '⚠️ Fair', [\"Apdex Score\"] <= 0.94, '✔️ Good', '✔️ Excellent')\r\n| project Values = InterestingDimension, [\"Apdex Score\"], [\"Apdex Interpretation\"], [\"Satisfied Users\"], [\"Tolerating Users\"], [\"Frustrated Users\"]\r\n",
            "segmentColumn": " ",
            "timeColumn": "Frustrated Users",
            "timeGrain": "auto",
            "timeGrainType": "auto",
            "valueColumn": "Frustrated Users"
          },
          "azureLogAnalytics": {
            "query": "\r\nlet apdexThreshhold = toint('$ApdexThresholdInMilliseconds');\r\nlet failureThreshhold = 1;\napp('/subscriptions/$subscriptions/resourceGroups/$resourcegroups/providers/$namespace/$resourcenames').pageViews\r\n| where  $__timeFilter(timestamp)\r\n| where name in ('*') or '*' in ('*')\r\n| extend success = columnifexists('success', true)\r\n| extend Failure = iff('ConsiderFailures' == 'ConsiderFailures' and success == false, 1, 0)\r\n| extend InterestingDimension = iff(isempty(name)== true, 'Unknown', name)\r\n| where InterestingDimension in ('*') or '*' in ('*')\r\n| summarize AverageDuration = avg(duration), Failures = sum(Failure) by user_Id, bin(timestamp, 30m)\r\n| extend UserExperience = case(AverageDuration <= apdexThreshhold, 'Satisfied', AverageDuration <= 4 * apdexThreshhold, 'Tolerating', 'Frustrated')\r\n| extend UserExperience = case(Failures >= failureThreshhold, \"Frustrated\", UserExperience)\r\n| summarize count() by UserExperience, timestamp\n| order by timestamp asc",
            "resultFormat": "time_series",
            "workspace": "77fc47c8-51ea-4839-8155-d8c6896fcc76"
          },
          "azureMonitor": {
            "aggOptions": [],
            "dimensionFilter": "*",
            "dimensionFilters": [],
            "metricDefinition": "select",
            "metricName": "select",
            "metricNamespace": "select",
            "resourceGroup": "select",
            "resourceName": "select",
            "timeGrain": "auto",
            "timeGrains": [],
            "top": "10"
          },
          "datasource": {
            "type": "grafana-azure-monitor-datasource",
            "uid": "000000003"
          },
          "hide": false,
          "insightsAnalytics": {
            "query": "",
            "resultFormat": "time_series"
          },
          "queryType": "Azure Log Analytics",
          "refId": "A",
          "subscription": "dae9d4f9-547a-4ea7-a419-b1c34a8f9d3f"
        }
      ],
      "title": "$resourcenames Quality Trend",
      "type": "timeseries"
    }
  ],
  "preload": false,
  "refresh": "",
  "schemaVersion": 41,
  "tags": [
    "Azure",
    "Apdex",
    "ApplicationInsights"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "text": "Azure-Mon-PROD",
          "value": "000000003"
        },
        "includeAll": false,
        "label": "Application Insights Source",
        "name": "datasource2",
        "options": [],
        "query": "grafana-azure-monitor-datasource",
        "refresh": 1,
        "regex": "",
        "type": "datasource"
      },
      {
        "current": {
          "text": "Production - CSP",
          "value": "da260ecc-9137-4f3b-83b5-dfc5192db411"
        },
        "datasource": {
          "type": "grafana-azure-monitor-datasource",
          "uid": "$datasource2"
        },
        "definition": "Subscriptions()",
        "includeAll": false,
        "label": "Subscriptions",
        "name": "subscriptions",
        "options": [],
        "query": "Subscriptions()",
        "refresh": 1,
        "regex": "",
        "type": "query"
      },
      {
        "current": {
          "text": "vks-performinsights-rg",
          "value": "vks-performinsights-rg"
        },
        "datasource": {
          "type": "grafana-azure-monitor-datasource",
          "uid": "$datasource2"
        },
        "definition": "ResourceGroups($subscriptions)",
        "includeAll": false,
        "label": "Resource Groups",
        "name": "resourcegroups",
        "options": [],
        "query": "ResourceGroups($subscriptions)",
        "refresh": 1,
        "regex": "/.*insights.*|.*learn/",
        "type": "query"
      },
      {
        "current": {
          "text": "microsoft.insights/components",
          "value": "microsoft.insights/components"
        },
        "datasource": {
          "type": "grafana-azure-monitor-datasource",
          "uid": "$datasource2"
        },
        "definition": "Namespaces($resourcegroups)",
        "includeAll": false,
        "label": "Namespace",
        "name": "namespace",
        "options": [],
        "query": "Namespaces($resourcegroups)",
        "refresh": 1,
        "regex": "/^microsoft.insights.*|^Microsoft.Insights.*/",
        "type": "query"
      },
      {
        "current": {
          "text": "vks-perform-ai",
          "value": "vks-perform-ai"
        },
        "datasource": {
          "type": "grafana-azure-monitor-datasource",
          "uid": "$datasource2"
        },
        "definition": "ResourceNames($resourcegroups, $namespace)",
        "includeAll": false,
        "label": "Resource Names",
        "name": "resourcenames",
        "options": [],
        "query": "ResourceNames($resourcegroups, $namespace)",
        "refresh": 1,
        "regex": "",
        "type": "query"
      },
      {
        "current": {
          "text": "*",
          "value": "*"
        },
        "label": "Operations",
        "name": "operations",
        "options": [
          {
            "selected": true,
            "text": "*",
            "value": "*"
          }
        ],
        "query": "*",
        "type": "textbox"
      },
      {
        "current": {
          "text": "2250",
          "value": "2250"
        },
        "label": "Apdex Threshold (ms)",
        "name": "ApdexThresholdInMilliseconds",
        "options": [
          {
            "selected": true,
            "text": "2250",
            "value": "2250"
          }
        ],
        "query": "2250",
        "type": "textbox"
      }
    ]
  },
  "time": {
    "from": "now-7d",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h",
      "2h",
      "1d"
    ]
  },
  "timezone": "",
  "title": "App Insights Apdex",
  "uid": "S7Q9Tq-Zz",
  "version": 72
}
